<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>HackerCanvas</title>

<script src="https://unpkg.com/gifler@0.1.0/gifler.min.js"></script>

<style>
/* âœ… Black & White Theme */
:root {
    --accent:#ffffff;   /* White */
    --bg:#000000;       /* Black */
    --dim:#333333;      /* Dark Gray */
}

*{
    box-sizing:border-box;
    -webkit-tap-highlight-color:transparent;
}

body,html{
    margin:0;
    height:100%;
    background:var(--bg);
    color:var(--accent);
    font-family:Courier New,monospace;
    display:flex;
    align-items:center;
    justify-content:center;
}

.app-container{
    width:95%;
    max-width:450px;
    border:1px solid var(--accent);
    background:rgba(255,255,255,.03); /* White Blur */
}

.terminal-header{
    background:var(--accent);
    color:#000;
    padding:10px;
    font-size:11px;
    font-weight:900;
    display:flex;
    justify-content:space-between;
    letter-spacing:2px;
}

.header-dots{display:flex;gap:5px}

.dot{
    width:8px;
    height:8px;
    border-radius:50%;
    background:#000;
}

.terminal-content{
    padding:20px;
    display:flex;
    flex-direction:column;
    gap:15px;
}

#canvas-wrapper{
    border:1px solid var(--dim);
    aspect-ratio:1/1;
    background:#050505;
}

canvas{
    width:100%;
    height:100%;
    filter:grayscale(100%) contrast(170%);
}

.btn-group{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
}

button{
    background:transparent;
    border:1px solid var(--accent);
    color:var(--accent);
    padding:12px;
    font-weight:bold;
    cursor:pointer;
}

button:hover{
    background:var(--accent);
    color:#000;
}

button:disabled{
    opacity:.4;
}

#status-bar{
    text-align:center;
    font-size:10px;
}

/* Recording Blink (Only Red Allowed) */
.rec-active{
    animation:blink .8s infinite;
    color:#ff0000;
}

@keyframes blink{
    50%{opacity:.4}
}

.footer-info{
    font-size:10px;
    text-align:center;
    opacity:.5;
    letter-spacing:3px;
}
</style>
</head>

<body>

<div class="app-container">

<div class="terminal-header">
<div class="header-dots">
<div class="dot"></div>
<div class="dot"></div>
</div>
<span>HackerCanvas</span>
<span>Anonymous</span>
</div>

<div class="terminal-content">

<div id="canvas-wrapper">
<canvas id="outputCanvas" width="500" height="500"></canvas>
</div>

<div id="status-bar">SYSTEM: READY</div>

<div class="btn-group">
<button id="startBtn">RECORD</button>
<button id="stopBtn" disabled>KILL</button>
</div>

<div class="footer-info">Humayun Shariar Himu</div>

</div>
</div>


<script>

const canvas = document.getElementById("outputCanvas");
const status = document.getElementById("status-bar");

let recorder;
let audioCtx;
let chunks=[];


// GIF
gifler("./image.gif").get(g=>{
    g.animateInCanvas(canvas);
});


// ðŸŽ§ Hacker Voice Engine (UNCHANGED)
async function getHackerAudio(stream){

    audioCtx=new AudioContext();

    const source=audioCtx.createMediaStreamSource(stream);
    const dest=audioCtx.createMediaStreamDestination();

    const bass=audioCtx.createBiquadFilter();
    bass.type="lowshelf";
    bass.frequency.value=200;
    bass.gain.value=30;

    const bandpass=audioCtx.createBiquadFilter();
    bandpass.type="bandpass";
    bandpass.frequency.value=900;
    bandpass.Q.value=1.4;

    const distortion=audioCtx.createWaveShaper();

    function makeDist(amount){
        const n=44100;
        const curve=new Float32Array(n);

        for(let i=0;i<n;i++){
            const x=i*2/n-1;
            curve[i]=(3+amount)*x*20*Math.PI/(Math.PI+amount*Math.abs(x));
        }

        return curve;
    }

    distortion.curve=makeDist(180);
    distortion.oversample="4x";


    const comp=audioCtx.createDynamicsCompressor();

    comp.threshold.value=-25;
    comp.knee.value=30;
    comp.ratio.value=12;
    comp.attack.value=0.003;
    comp.release.value=0.25;


    source
    .connect(bass)
    .connect(bandpass)
    .connect(distortion)
    .connect(comp)
    .connect(dest);

    return dest.stream;
}



// â–¶ START
document.getElementById("startBtn").onclick=async()=>{

try{

    status.innerText="ACCESSING MIC...";

    const mic=await navigator.mediaDevices.getUserMedia({audio:true});

    const hackerVoice=await getHackerAudio(mic);

    const video=canvas.captureStream(30);

    const stream=new MediaStream([
        ...video.getVideoTracks(),
        ...hackerVoice.getAudioTracks()
    ]);

    recorder=new MediaRecorder(stream);

    chunks=[];

    recorder.ondataavailable=e=>chunks.push(e.data);

    recorder.onstop=()=>{

        const blob=new Blob(chunks,{type:"video/webm"});

        const url=URL.createObjectURL(blob);

        const a=document.createElement("a");
        a.href=url;
        a.download="HACKER_"+Date.now()+".webm";
        a.click();

        status.innerText="FILE EXPORTED";
        status.classList.remove("rec-active");
    };

    recorder.start();

    status.innerText="RECORDING...";
    status.classList.add("rec-active");

    startBtn.disabled=true;
    stopBtn.disabled=false;

}
catch(err){

    console.error(err);
    status.innerText="MIC DENIED";

}
};



// â¹ STOP
document.getElementById("stopBtn").onclick=()=>{

    recorder.stop();

    if(audioCtx) audioCtx.close();

    startBtn.disabled=false;
    stopBtn.disabled=true;

};

</script>

</body>
</html>
